<VirtualHost *:80>
    ServerName dev.www.manheim.co.uk
    ServerAlias dev.www.manheim.co.uk
    DocumentRoot /export/mol-uk/manheim.co.uk

    <Directory "/">
        Order deny,allow
        Deny from all
    </Directory>
    <Directory "/export/mol-uk/manheim.co.uk">
        Options FollowSymLinks
        Order allow,deny
        Allow from all
    </Directory>

    TransferLog "|/usr/bin/cronolog /export/bigIP/logs/uk/%Y/%m/%d/spoofBigIp_access_log"
    ErrorLog    "|/usr/bin/cronolog /export/bigIP/logs/uk/%Y/%m/%d/spoofBigIp_error_log"

    # Turn off proxy requests to prevent spam relaying, etc.
    ProxyRequests Off
    RewriteEngine On

    RewriteRule ^/(.*) http://127.0.0.1:8000/$1 [P]
    ProxyPassReverse /  http://127.0.0.1:8000/
    ProxyPreserveHost On

    SetOutputFilter DEFLATE
    SetEnv gzip-only-text/html 1
    header append Vary User-Agent env=!dont-vary
    BrowserMatch ^Mozilla/4\.0[678] no-gzip
</VirtualHost>

<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName dev.www.manheim.co.uk
    ServerAlias dev.www.manheim.co.uk
    DocumentRoot /export/mol-uk/manheim.co.uk

    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>
    <Directory "/">
        Order deny,allow
        Deny from all
    </Directory>
    <Directory "/export/mol-uk/manheim.co.uk">
        Options FollowSymLinks
        Order allow,deny
        Allow from all
    </Directory>

    TransferLog "|/usr/bin/cronolog /export/bigIP/logs/uk/%Y/%m/%d/spoofBigIp_secure_access_log"
    ErrorLog    "|/usr/bin/cronolog /export/bigIP/logs/uk/%Y/%m/%d/spoofBigIp_secure_error_log"

    ProxyRequests Off
    RewriteEngine On
    
    RewriteRule ^/(.*) http://127.0.0.1:8443 [P]
    ProxyPassReverse /  http://127.0.0.1:8443

    ProxyPreserveHost On

    SetOutputFilter DEFLATE
    SetEnv gzip-only-text/html 1
    header append Vary User-Agent env=!dont-vary

    SSLEngine on
    SSLProxyEngine On
    SSLCipherSuite ALL:!ADH:!EXPORT56:-AES256-SHA:-DHE-RSA-AES256-SHA:-DHE-DSS-AES256-SHA:RC4+RSA:+HIGH:+MEDIUM:+LOW:!SSLv2:+EXP:+eNULL
    LogLevel notice
    SSLCertificateFile    /etc/ssl/certs/ssl-cert-snakeoil.pem
    SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key

    BrowserMatch ".*MSIE.*" \
                nokeepalive ssl-unclean-shutdown \
                downgrade-1.0 force-response-1.0
    BrowserMatch ^Mozilla/4\.0[678] no-gzip
</VirtualHost>
</IfModule>

